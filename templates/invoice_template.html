<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8">
  <title>TAX INVOICE | VYSEDECK AI Ventures Pvt Ltd | {{ invoice_number }}</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 40px;
      font-size: 11px;
      color: #333;
    }

    /* --- Colors --- */
    :root {
      --primary-color: #104084;
      --secondary-bg: #f5f7fa;
      --accent-color: #2e6bc6;
      --line-color: #ddd;
    }


    .flex-container {
      display: table;
      width: 100%;
      margin-bottom: 20px;
    }

    .flex-column {
      display: table-cell;
      vertical-align: top;
      padding: 0 10px;
    }

    .w-50 {
      width: 50%;
    }

    .w-60 {
      width: 60%;
    }

    .w-40 {
      width: 40%;
    }

    /* --- Header and Title --- */
    .header-section {
      border-bottom: 1px solid var(--line-color);
      padding-bottom: 10px;
      margin-bottom: 25px;
    }

    h1 {
      color: var(--primary-color);
      font-size: 26px;
      font-weight: 900;
      text-transform: uppercase;
      margin: 0;
    }

    .logo-placeholder {
      width: 150px;
      height: 40px;
      background-color: var(--primary-color);
      color: white;
      text-align: center;
      line-height: 40px;
      font-weight: bold;
      font-size: 14px;
    }

    .address-title,
    .details-title,
    .usage-title {
      font-size: 14px;
      font-weight: bold;
      color: #222;
      margin-top: 5px;
      margin-bottom: 5px;
      border-bottom: 1px solid #eee;
      padding-bottom: 2px;
    }

    address {
      font-style: normal;
      margin-top: 10px;
      line-height: 1.5;
    }

    address strong {
      font-size: 13px;
      color: var(--primary-color);
      display: block;
      margin-bottom: 2px;
    }

    address p {
      margin: 2px 0;
    }

    /* Revised Address Field Styling for vertical alignment */
    .address-field {
      display: table;
      width: 100%;
      margin: 2px 0;
    }

    /* Setting a specific, generous width for the label ensures vertical alignment across columns */
    .address-label {
      display: table-cell;
      font-weight: bold;
      width: 90px;
      padding-right: 5px;
    }

    .address-value {
      display: table-cell;
      text-align: left;
      width: auto;
    }

    /* Remove previous horizontal contact styles to revert to vertical alignment */
    .contact-row-horizontal {
      display: block;
      margin-top: 10px;
    }

    .contact-item {
      margin-right: 0;
      white-space: normal;
    }

    .contact-label {
      font-weight: bold;
      margin-right: 5px;
    }

    .details-box p {
      margin: 4px 0;
      display: table;
      width: 100%;
    }

    .details-box span {
      display: table-cell;
      padding: 0 5px;
    }

    .details-label {
      font-weight: bold;
      text-align: left;
      width: 110px;
    }

    .details-value {
      text-align: right;
    }

    /* --- Item Table Styling --- */
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 30px;
      page-break-inside: auto;
    }

    th,
    td {
      border: 1px solid var(--line-color);
      padding: 10px;
      text-align: left;
      border-top: none;
      border-left: none;
      border-right: none;
    }

    th {
      background: #f8f8f8;
      color: #555;
      font-weight: bold;
      text-transform: uppercase;
      font-size: 10px;
      border-bottom: 2px solid var(--primary-color);
    }

    .item-description {
      width: 50%;
    }

    /* --- Totals Rows --- */
    .total-row td {
      text-align: right;
      border: none;
      padding: 5px 10px;
    }

    .total-label {
      font-weight: normal;
      width: 70%;
    }

    .total-amount {
      width: 30%;
    }

    .total-row-final td {
      border-top: 3px double var(--primary-color);
      font-size: 14px;
      font-weight: bold;
      padding: 12px 10px;
      background: var(--secondary-bg);
    }

    /* --- Footer --- */
    .bank-info {
      margin-top: 40px;
      padding-top: 15px;
    }

    .bank-info p {
      margin: 5px 0;
    }

    .small-header {
      font-size: 14px;
      margin: 0 0 10px 0;
      color: var(--primary-color);
      font-weight: bold;
    }
  </style>

</head>

<body>

  <!-- 1. Header and Logo/Title -->

  <div class="flex-container header-section">
    <div class="flex-column w-50">
      <h1 style="color: #222;">Invoice</h1>
    </div>
    <div class="flex-column w-50" style="text-align: right;">
      <!-- Placeholder for VYSEDECK Logo -->
      <div class="logo-placeholder" style="margin-left: auto;">VYSEDECK</div>
    </div>
  </div>

  <!-- 2. Address Row: Bill From and Bill To (in the same row, 50/50 split) -->

  <div class="flex-container">
    <!-- Bill From (Vendor) -->
    <div class="flex-column w-50" style="padding-left: 0;">
      <div class="address-title">From (Vendor)</div>
      <address>
        <strong>VYSEDECK AI Ventures Pvt Ltd</strong>
        <p>H1A/20, SECTOR-63, Noida</p>
        <p>Uttar Pradesh, India, 201301</p>

        <!-- ALIGNED VERTICAL FIELDS FOR CONTACT DETAILS -->
        <div class="address-field">
          <span class="address-label">GSTIN:</span>
          <span class="address-value">09AAKCV7915Q1ZA</span>
        </div>
        <div class="address-field">
          <span class="address-label">Phone:</span>
          <span class="address-value">+91 9999999999</span>
        </div>
        <div class="address-field">
          <span class="address-label">Email:</span>
          <span class="address-value">invoicing@vysedeck.com</span>
        </div>
        <!-- END ALIGNED VERTICAL FIELDS -->
      </address>
    </div>

    <!-- Bill To (Client) -->
    <div class="flex-column w-50" style="padding-right: 0;">
      <div class="address-title">Bill To (Client)</div>
      <address>
        <strong>{{ companyInfo.legalName | default("Client Name Missing") }}</strong>
        <p>{{ companyInfo.billingAddress.address | default("Address Not Available") }}</p>

        <!-- ALIGNED VERTICAL FIELDS FOR CONTACT DETAILS -->
        <div class="address-field">
          <span class="address-label">GSTIN:</span>
          <span class="address-value">{{ companyInfo.billingAddress.gstNumber | default("N/A") }}</span>
        </div>
        <div class="address-field">
          <span class="address-label">Phone:</span>
          <span class="address-value">{{ companyInfo.phoneNumber | default("N/A") }}</span>
        </div>
        <div class="address-field">
          <span class="address-label">Email:</span>
          <span class="address-value">{{ companyInfo.billingEmail | default("N/A") }}</span>
        </div>
        <!-- END ALIGNED VERTICAL FIELDS -->
      </address>
    </div>

  </div>

  <!-- 3. Details Row: Invoice Details and Usage Summary (in the same row, 50/50 split) -->

  <div class="flex-container" style="margin-top: 10px;">
    <!-- Invoice Details -->
    <div class="flex-column w-50" style="padding-left: 0;">
      <div class="details-title">Invoice Details</div>
      <div class="details-box">
        <p><span class="details-label">Invoice #</span><span class="details-value">{{ invoice_number | default("N/A")
            }}</span></p>
        <p><span class="details-label">Invoice Date</span><span class="details-value">{{ invoiceDate[:10] |
            default("N/A") }}</span></p>
        <p><span class="details-label">Due Date</span><span class="details-value">{{ dueDate[:10] | default("N/A")
            }}</span></p>
        <p><span class="details-label">Billing Period</span><span class="details-value">{{ billingPeriod.startDate[:10]
            | default("N/A") }} - {{ billingPeriod.endDate[:10] | default("N/A") }}</span></p>
      </div>
    </div>

    <!-- Usage Summary -->
    <div class="flex-column w-50" style="padding-right: 0;">
      <div class="usage-title">Usage Summary</div>
      <div class="details-box">
        <p><span class="details-label">Total Calls</span><span class="details-value">{{ usageData.totalCalls |
            default(0) }}</span></p>
        <p><span class="details-label">Billed Minutes</span><span class="details-value">{{ usageData.totalBilledMinutes
            | default(0) }}</span></p>
        <p><span class="details-label">Total Duration</span><span class="details-value">{{ (usageData.totalSeconds)
            | default(0) }} secs</span></p>
        <p><span class="details-label">Billing Policy</span><span class="details-value">{{ usageData.billingPolicy |
            default("N/A") }}</span></p>
      </div>
    </div>

  </div>

  <!-- 4. Itemized Charges Table -->

  <table>
    <thead>
      <tr>
        <th class="item-description">Item & Description</th>
        <th style="width: 10%; text-align: center;">Qty</th>
        <th style="width: 20%; text-align: right;">Rate (Rs.)</th>
        <th style="width: 20%; text-align: right;">Amount (Rs.)</th>
      </tr>
    </thead>
    <tbody>
      <!-- 1. Call Usage Charges -->
      <tr>
        <td>Call Usage ({{ usageData.totalBilledMinutes | default(0) }} billed minutes @ ₹{{ "%.2f" |
          format(billingRates.ratePerMinute | default(0)) }} per minute)</td>
        <td style="text-align: center;">{{ usageData.totalBilledMinutes | default(0) }}</td>
        <td style="text-align: right;">{{ "%.2f" | format(billingRates.ratePerMinute | default(0)) }}</td>
        <td style="text-align: right;">{{ "%.2f" | format(subtotal - billingRates.maintenanceFee | default(0)) }}</td>
      </tr>
      <!-- 2. Maintenance Fee (Conditionally shown if value is greater than zero) -->
      {% if billingRates.maintenanceFee and billingRates.maintenanceFee > 0 %}
      <tr>
        <td>Monthly Platform Maintenance Fee</td>
        <td style="text-align: center;"></td>
        <td style="text-align: right;">{{ "%.2f" | format(billingRates.maintenanceFee) }}</td>
        <td style="text-align: right;">{{ "%.2f" | format(billingRates.maintenanceFee) }}</td>
      </tr>
      {% endif %}

      <!-- 5. Totals Rows -->

      <tr class="total-row">
        <td colspan="3" class="total-label">Subtotal (Usage + Fee)</td>
        <td class="total-amount">₹ {{ "%.2f" | format(subtotal | default(0)) }}</td>
      </tr>
      <tr class="total-row">
        <td colspan="3" class="total-label">GST ({{ billingRates.gstRate | default(0) }}%)</td>
        <td class="total-amount">₹ {{ "%.2f" | format(gstAmount | default(0)) }}</td>
      </tr>
      <tr class="total-row-final">
        <td colspan="3" class="total-label" style="text-transform: uppercase;">Total Amount Due</td>
        <td class="total-amount">₹ {{ "%.2f" | format(totalAmount | default(0)) }}</td>
      </tr>
    </tbody>
  </table>

  <!-- 6. Payment Instructions and Footer -->

  <div class="bank-info">
    <div class="small-header">Payment Instructions</div>
    <p>Please remit the total amount by {{ dueDate[:10] | default("N/A") }}</p>
    <p>to the following bank account:</p>

    <div class="flex-container" style="margin-top: 10px;">
      <div class="flex-column w-50" style="padding-left: 0;">
        <p style="font-size: 11px;"><strong>Bank Name:</strong> {{ companyInfo.bankName | default("N/A") }}</p>
        <p style="font-size: 11px;"><strong>Account Number:</strong> {{ companyInfo.accountNumber | default("N/A")
          }}
        </p>
        <p style="font-size: 11px;"><strong>IFSC Code:</strong> {{ companyInfo.ifscCode | default("N/A") }}</p>
      </div>
      <div class="flex-column w-50" style="padding-right: 0; text-align: right;">
        <p style="font-size: 11px;">Thank you for your business.</p>
      </div>
    </div>

  </div>

</body>

</html>